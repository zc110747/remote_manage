# 1.U-Boot开发技术

## 1.1 U-Boot综述
U-Boot，又称Universal Boot Loader, 是遵循GPL条款的开放源代码项目，在嵌入式Linux系统中负责对于系统的引导，其功能有点类似与windows系统中的BIOS，Uboot目录的结构如下所示。<br />

| name     | function     |
| -------   | -------- | 
| api | 与硬件无关的接口函数 | 
| **arch** | **与芯片架构体系有关的代码** |
| **board** | **板级的定制代码** |
| cmd | 支持命令的代码 |
| common | 通用代码 |
| configs | 配置文件 |
| **disk** | **磁盘分区的代码** |
| doc | 文档 |
| **dirvers** | **驱动** |
| **dts** | **设备树** |
| examples | 例程代码 |
| **fs** | **文件系统 **|
| include | 头文件 |
| lib | 库文件 |
| Licenses | 许可证文件 |
| net | 网络相关文件 | 
| post | 上电自检程序 | 
| **scripts** | **脚本文件** |
| test | 测试文件 |
| tools | 工具文件 |


# 2.常见知识总结

## 2.1 进程，线程和协程区别和联系
1.进程是资源调度的基本单位，一个进程可以有多个线程，但至少有一个线程.<br/>
2.线程是程序执行的基本单位，是轻量级的进程，协程是用户态轻量级的线程，线程内部调度的基本单位.<br/>
3.线程启动速度快，轻量级，系统开销小.<br/>

## 2.2 串行，并行和并发
串行: 一次只能取得一个任务并执行这个任务，这个任务执行完后面才能继续.<br/>
并发:指在同一时间段内，多条指令在CPU上同时执行.<br/>
并行:指在同一时刻时，多条指令在CPU上同时执行.<br/>
串行通讯: 数据按位顺序进行传输, 最少采用单线即可传输，包含USART，SPI， I2C或单线通讯等.<br/>
并行通讯:多个bit数据通过并行线进行传输.<br/>

## 2.3 进程调度算法
1.先来先服务(first come, first serverd- fcfs)<br/>
&emsp;&emsp;非抢占式的调度算法，按照请求的顺序进行调度，有利于长作业，不利于短作业，会造成短作业等待时间过长.<br/>
2.短作业优先(shortest job first – sjf)<br/>
&emsp;&emsp;非抢占式的调度算法，按估计运行时间最短的顺序进行调度。长作业可能永远无法执行.<br/>
3.最短剩余时间优先(shortest remaining time next – srtn)<br/>
&emsp;&emsp;最短作业优先的抢占式版本，按剩余运行时间的顺序进行调度。当一个新的作业到达时，整个运行时间与当前进程的剩余时间作比较。执行剩余运行时间最短的顺序进行调度.<br/>
4.时间片轮转<br/>
&emsp;&emsp;将所有就绪进程按FCFS的原则排成一个队列，每次调度时，将CPU时间分配给首进程，该进程可以执行一个时间片，当时间片用完后，由定时器发出时钟中断，调度程序便停止该进程的执行，并将它送往就绪队列的末尾，同时继续将CPU时间分配给队首的进程.<br/>
5.优先级调度<br/>
&emsp;&emsp;为每个进程分配优先级，按优先级进行调度.<br/>
6.多级反馈队列<br/>
&emsp;&emsp;时间片轮转调度算法和优先级调度算法的结合.<br/>

## 2.4 进程间通信方式
1.管道<br/>
&emsp;&emsp;无名管道(内存文件):管道是一种半双工的通信方式，数据只能单向流动，而且只能在具有亲缘关系的进程之间使用.<br/>
&emsp;&emsp;有名管道(FIFO文件):有名管道也是半双工的通信方式，允许在没有亲缘关系的进程之间使用，管道是先进先出的通讯方式.<br/>
2.共享内存<br/>
&emsp;&emsp;共享内存就是映射一段被其它进程所访问的内存，这段内存由一个进程创建，但多个进程都可以访问，共享内存和最快的IPC方式，和信号量配合使用，实现进程间的同步通信.<br/>
3.消息队列<br/>
&emsp;&emsp;消息队列是有消息的链表，存放在内核中并由消息队列标识符标识.<br/>
4.套接字<br/>
&emsp;&emsp;适用于不同机器间进程通讯，在本地也可作为两个进程通信.<br/>
5.信号<br/>
&emsp;&emsp;用于通知接收进程某个事件已经发生，例如键盘事件.<br/>
6.信号量<br/>
&emsp;&emsp;信号量是一个计数器，可以用来控制多个进程对共享资源的访问.<br/>

## 2.5 动态分区分配算法
1.首次适应算法<br/>
&emsp;&emsp;每次都从低地址开始查找，找到第一个满足大小的空闲分区.<br/>
2.最佳适应算法<br/>
&emsp;&emsp;将空闲分区按容量递增次序链接，每次分配查找大小能满足要求的第一个空闲分区.<br/>
3.最大适应算法<br/>
&emsp;&emsp;将空闲分区按容量递减次序链接，每次分配查找大小能满足要求的第一个空闲分区.<br/>
4.邻近适应算法<br/>
&emsp;&emsp;空闲分区以地址递增的顺序排列(可排成-一个循环链表)。每次分配内存时从上次查找结束的位置开始查找空闲分区链(或空闲分区表)，找到大小能满足要求的第一个空闲分区<br/>

## 2.6 常见几种磁盘调度算法
1.先来先服务<br/>
&emsp;&emsp;按照磁盘请求的顺序进行调度.<br/>
2.最短寻道时间优先<br/>
&emsp;&emsp;优先调度与当前磁头所在磁道距离最近的磁道.<br/>
3.电梯扫描算法<br/>
&emsp;&emsp;总是按一个方向来进行磁盘调度，直到该方向上没有未完成的磁盘请求，然后改变方向.<br/>

## 2.7 常见的几种锁
1.读写锁<br />
&emsp;&emsp;可以同时读，写必须互斥，写优先于读.
2.互斥锁<br />
&emsp;&emsp;一次只能一个线程拥有互斥锁，其他线程只有等待.
3.条件变量<br />
&emsp;&emsp;条件变量通过允许线程阻塞和等待另一个线程发送信号的方法弥补了互斥锁的不足，他常和互斥锁一起使用，以免出现竞态条件
4.自旋锁<br />
&emsp;&emsp;如果进线程无法取得锁，进线程不会立刻放弃CPU时间片，而是一直循环尝试获取锁，直到获取为止。

# 3.TCP/IP网络协议

对于TCP/IP协议的学习，看过的书籍如下:<br />
1.<TCP/IP详解><br />
2.<嵌入式网络那些事:LwIP协议深度剖析和实战演练><br />
3.<HTTP权威指南><br />

## 3.1 协议分层
<table>
    <tr>
        <td>OSI模型</td>
        <td>物理层</td>
        <td>数据链路层</td>
        <td>网络层</td>
        <td>传输层</td>
        <td>会话层</td>
        <td>表示层</td>
        <td>应用层</td>
    </tr>
    <tr>
        <td>TCP/IP模型</td>
        <td></td>
        <td>网络接口层</td>
        <td>网络层</td>
        <td>传输层</td>
        <td></td>
        <td></td>
        <td>应用层</td>
    </tr>
</table>
对于TCP/IP协议，主要说明功能如下:<br />
1. 网络接口层<br />
&emsp;&emsp;负责网络上的数据帧的接收和发送，由MAC+PHY两部分组成, 一般CPU中集成MAC，外挂PHY芯片，如常用的ip101gr,LAN8702A.CPU和PHY交互的接口分为用于配置的SMI接口(MDC/MDIO)和用于通讯的MII/RMII接口。MAC用于完成链路层的数据解析，发送时进行组包，接收时进行解包。PHY则是处理网络模拟信号和数字量的转换.<br />
&emsp;&emsp;除必要的通讯口外，如果使用MII接口，MII_RX_ER用于检测是否有错误包，如果未连接，会导致接收包错误丢弃.<br />
&emsp;&emsp;网络接口层的协议格式如下:<br />

| 目的端MAC地址 | 源端MAC地址 | 协议类型 |
| -------   | -------- | -------- |
| 6字节    | 6字节     |  2字节 |
其中协议类型, 0x0806是ARP包，0x0800是IP数据包.<br />
对于ARP协议，目的端IP地址为全0xFF 0xFF 0xFF 0xFF, 通过ARP协议获取目的的IP地址.<br />

2.网络层<br />
&emsp;&emsp;网络层的协议主要包含IP，ARP和RARP协议.<br />
&emsp;&emsp;对于ARP协议，全称Address Resolution Protocol(地址解析协议)，它是一个通过用于实现从IP地址到MAC地址的映射，既询问目标IP对应的MAC地址的一种协议.<br />
&emsp;&emsp;对于设备端，在内部维护一个ARP的缓存表，当用IP地址访问远端设备时，会先检查缓存表里是否存在

